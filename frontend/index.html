<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>LAZ Terrain Processor</title>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
  <link rel="stylesheet" as="style" onload="this.rel='stylesheet'" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <!-- Leaflet CSS and JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
  <link rel="stylesheet" href="/static/styles.css" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="/static/app.js"></script>
</head>
<body class="bg-[#141414] text-white" style='font-family: Inter, "Noto Sans", sans-serif;'>
  <div class="flex flex-col h-screen overflow-hidden">
  <!-- Header with modern design -->
  <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#303030] px-10 py-3">
    <div class="flex items-center gap-4 text-white">
      <div class="size-4">
        <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 4H17.3334V17.3334H30.6666V30.6666H44V44H4V4Z" fill="currentColor"></path>
        </svg>
      </div>
      <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">LAZ Terrain Processor</h2>
    </div>
    <div class="flex flex-1 justify-end gap-8">
      <button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 bg-[#303030] text-white gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5">
        <div class="text-white" data-icon="Question" data-size="20px" data-weight="regular">
          <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256">
            <path d="M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"></path>
          </svg>
        </div>
      </button>
    </div>
  </header>

  <!-- Main content area with modern layout -->
  <div class="flex flex-1 overflow-hidden">
    <!-- Sidebar -->
    <div id="sidebar" class="bg-[#1a1a1a] border-r border-[#303030] w-64 p-6 flex flex-col overflow-y-auto">
      <!-- LAZ File Selection Section -->
      <div class="accordion-section mb-6">
        <div class="accordion-header bg-[#303030] hover:bg-[#404040] cursor-pointer p-3 rounded-lg transition-colors" id="laz-accordion">
          <h3 class="text-white font-semibold flex justify-between items-center m-0">
            Select LAZ File
            <span class="accordion-arrow text-sm transition-transform">â–¼</span>
          </h3>
        </div>
        <div class="accordion-content bg-[#262626] rounded-lg mt-2 p-3" id="laz-content">
          <div class="selected-file flex items-center gap-3">
            <span id="selected-file-name" class="text-[#666] text-sm flex-1 min-w-0 break-all">No file selected</span>
            <button id="browse-files" class="browse-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-3 py-1 rounded text-sm font-medium transition-colors">Browse...</button>
          </div>
        </div>
      </div>

      <!-- Processing Steps -->
      <div class="flex-1">
        <h3 class="text-white font-semibold mb-4">Processing Steps</h3>
        <div class="space-y-2" id="processing-steps-container">
          <button id="test-overlay-btn" class="w-full bg-[#ff6b35] hover:bg-[#e55a2e] text-white px-4 py-3 rounded-lg font-medium transition-colors">ðŸ§ª Test Overlay</button>
          <div>
            <input type="checkbox" id="dem-checkbox" data-target="laz_to_dem" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
            <label for="dem-checkbox" class="ml-2 text-white">DEM</label>
          </div>
          <div>
            <input type="checkbox" id="dsm-checkbox" data-target="dsm" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
            <label for="dsm-checkbox" class="ml-2 text-white">DSM</label>
          </div>
          <div>
            <input type="checkbox" id="chm-checkbox" data-target="chm" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
            <label for="chm-checkbox" class="ml-2 text-white">CHM</label>
          </div>
          <div>
            <input type="checkbox" id="dtm-checkbox" data-target="dtm" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500" checked>
            <label for="dtm-checkbox" class="ml-2 text-white">DTM</label>
          </div>
          <div>
            <input type="checkbox" id="hillshade-checkbox" data-target="hillshade" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500" checked>
            <label for="hillshade-checkbox" class="ml-2 text-white">Hillshade</label>
          </div>
          <div>
            <input type="checkbox" id="slope-checkbox" data-target="slope" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500" checked>
            <label for="slope-checkbox" class="ml-2 text-white">Slope</label>
          </div>
          <div>
            <input type="checkbox" id="aspect-checkbox" data-target="aspect" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
            <label for="aspect-checkbox" class="ml-2 text-white">Aspect</label>
          </div>
          <div>
            <input type="checkbox" id="color_relief-checkbox" data-target="color_relief" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500" checked>
            <label for="color_relief-checkbox" class="ml-2 text-white">Color Relief</label>
          </div>
          <div>
            <input type="checkbox" id="tri-checkbox" data-target="tri" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
            <label for="tri-checkbox" class="ml-2 text-white">TRI</label>
          </div>
          <div>
            <input type="checkbox" id="tpi-checkbox" data-target="tpi" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
            <label for="tpi-checkbox" class="ml-2 text-white">TPI</label>
          </div>
          <div>
            <input type="checkbox" id="roughness-checkbox" data-target="roughness" class="form-checkbox h-5 w-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
            <label for="roughness-checkbox" class="ml-2 text-white">Roughness</label>
          </div>
        </div>
      </div>
    </div>

    <!-- Main processing area with map and gallery -->
    <div id="main" class="flex-1 p-6 bg-[#141414] overflow-y-auto">
      <div class="mb-6">
        <h1 class="text-white text-2xl font-bold">Terrain Analysis Results</h1>
        <p class="text-[#ababab] text-sm mt-2">Select processing steps from the sidebar to generate terrain analysis outputs</p>
      </div>
      
      <!-- World Map Canvas -->
      <div class="mb-6">
        <div id="map" class="w-full h-[800px] bg-[#1a1a1a] border border-[#303030] rounded-lg"></div>
      </div>
      
      <!-- Processing Results Gallery -->
      <div class="mb-4">
        <h2 class="text-white text-lg font-semibold mb-4">Processing Results</h2>
        <div id="gallery" class="flex gap-4 overflow-x-auto pb-4">
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-laz_to_dem">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="laz_to_dem">DEM</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="laz_to_dem">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-dtm">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="dtm">DTM</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="dtm">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-dsm">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="dsm">DSM</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="dsm">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-chm">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="chm">CHM</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="chm">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-hillshade">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="hillshade">Hillshade</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="hillshade">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-slope">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="slope">Slope</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="slope">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-aspect">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="aspect">Aspect</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="aspect">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-color_relief">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="color_relief">Color Relief</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="color_relief">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-tri">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="tri">TRI</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="tri">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-tpi">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="tpi">TPI</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="tpi">Add to Map</button>
          </div>
          <div class="gallery-item flex-shrink-0 w-64 h-48 bg-[#1a1a1a] border border-[#303030] rounded-lg flex flex-col hover:border-[#404040] transition-colors" id="cell-roughness">
            <div class="flex-1 flex items-center justify-center">
              <button class="proc-btn bg-[#00bfff] hover:bg-[#0099cc] text-white px-4 py-2 rounded font-medium transition-colors" data-target="roughness">Roughness</button>
            </div>
            <button class="add-to-map-btn hidden bg-[#28a745] hover:bg-[#218838] text-white px-3 py-1 rounded-b-lg text-sm font-medium transition-colors" data-target="roughness">Add to Map</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat interface with modern styling -->
  <div id="chatbar" class="bg-[#1a1a1a] border-t border-[#303030] p-4">
    <div id="chat-log" class="max-h-[150px] overflow-y-auto mb-3 space-y-2"></div>
    <div id="chat-controls" class="flex gap-3">
      <textarea id="chat-input" placeholder="Type a prompt..." class="flex-1 bg-[#262626] border border-[#404040] rounded-lg px-3 py-2 text-white placeholder-[#ababab] resize-none focus:outline-none focus:border-[#00bfff]"></textarea>
      <select id="chat-model" class="bg-[#262626] border border-[#404040] rounded-lg px-3 py-2 text-white focus:outline-none focus:border-[#00bfff]">
        <option value="o3">o3</option>
        <option value="4o">4o</option>
      </select>
      <button id="chat-send" class="bg-[#00bfff] hover:bg-[#0099cc] text-white px-6 py-2 rounded-lg font-medium transition-colors">Send</button>
    </div>
  </div>

  <!-- Modal for file selection with modern design -->
  <div id="file-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
    <div class="modal-content bg-[#1a1a1a] border border-[#303030] rounded-lg w-[90%] max-w-2xl">
      <div class="modal-header flex justify-between items-center p-6 border-b border-[#303030]">
        <h4 class="text-white text-lg font-semibold m-0">Select LAZ File</h4>
        <span class="close text-[#ababab] hover:text-white text-2xl cursor-pointer">&times;</span>
      </div>
      <div class="modal-body p-6">
        <div class="file-search mb-4">
          <input type="text" id="file-search-input" placeholder="Search files..." class="w-full bg-[#262626] border border-[#404040] rounded-lg px-3 py-2 text-white placeholder-[#ababab] focus:outline-none focus:border-[#00bfff]">
        </div>
        <div class="file-list max-h-80 overflow-y-auto bg-[#262626] rounded-lg border border-[#404040]" id="file-list">
          <!-- Files will be populated here -->
        </div>
      </div>
      <div class="modal-footer flex justify-end gap-3 p-6 border-t border-[#303030]">
        <button id="cancel-select" class="cancel-btn bg-[#666] hover:bg-[#555] text-white px-4 py-2 rounded-lg font-medium transition-colors">Cancel</button>
        <button id="select-file" class="select-btn bg-[#28a745] hover:bg-[#218838] text-white px-4 py-2 rounded-lg font-medium transition-colors">Select</button>
      </div>
    </div>
  </div>
</body>
</html>
